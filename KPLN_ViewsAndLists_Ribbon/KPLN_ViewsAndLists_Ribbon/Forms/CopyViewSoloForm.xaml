<Window x:Class="KPLN_ViewsAndLists_Ribbon.Forms.CopyViewSoloForm"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        mc:Ignorable="d"
        Title="Копирование шаблонов видов"
        Width="520"
        Height="650"
        MinWidth="480"
        MinHeight="520"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <DataTemplate x:Key="DocItemTemplate">
            <TextBlock Text="{Binding Name}" Margin="{Binding DisplayMargin}">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Setter Property="FontSize" Value="12"/>
                        <Setter Property="FontWeight" Value="SemiBold"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsLink}" Value="True">
                                <Setter Property="FontSize" Value="12"/>
                                <Setter Property="FontWeight" Value="Normal"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>
        </DataTemplate>
        <Style x:Key="ComboBoxAsTextBoxStyle" TargetType="ComboBox">
            <Setter Property="IsHitTestVisible" Value="False"/>
            <Setter Property="Focusable" Value="False"/>
            <Setter Property="Height" Value="23"/>
            <Setter Property="Padding" Value="6,2"/>
            <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}"/>
            <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Border
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="2"
                    Padding="{TemplateBinding Padding}">
                            <ContentPresenter
                        Content="{TemplateBinding SelectionBoxItem}"
                        ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                        ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                        VerticalAlignment="Center"
                        HorizontalAlignment="Left"
                        RecognizesAccessKey="True"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="12"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="12"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0"
           Text="Копировать в:"
           FontWeight="SemiBold"
           Margin="0,0,0,6"/>

        <ComboBox Grid.Row="1"
          ItemsSource="{Binding TargetDocs}"
          SelectedItem="{Binding SelectedTargetDoc}"
          ItemTemplate="{StaticResource DocItemTemplate}"
          IsSynchronizedWithCurrentItem="False"
          Style="{StaticResource ComboBoxAsTextBoxStyle}"/>

        <TextBlock Grid.Row="3"
           Text="Копировать из:"
           FontWeight="SemiBold"
           Margin="0,0,0,6"/>

        <ComboBox Grid.Row="4"
          Height="23"
          ItemsSource="{Binding SourceDocs}"
          SelectedItem="{Binding SelectedSourceDoc}"
          ItemTemplate="{StaticResource DocItemTemplate}"
          IsSynchronizedWithCurrentItem="False"/>


        <GroupBox Grid.Row="6" Header="Шаблоны видов (выбери для копирования)" Padding="8">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="8"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="8"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <DockPanel Grid.Row="0">
                    <TextBlock Text="{Binding TemplatesCountText}" Width="225" VerticalAlignment="Center"/>
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                        <Button Content="Выбрать всё" Padding="10,4" Margin="0,0,8,0" Click="SelectAll_Click"/>
                        <Button Content="Снять выбор всего" Padding="10,4" Click="ClearAll_Click"/>
                    </StackPanel>
                </DockPanel>

                <DockPanel Grid.Row="2">
                    <TextBlock Text="Поиск:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <TextBox Height="23" Width="372" VerticalAlignment="Center" Text="{Binding TemplateSearchText, UpdateSourceTrigger=PropertyChanged}" ToolTip="Начни вводить часть названия шаблона"/>
                    <Button Content="×" Width="28" Height="23" ToolTip="Очистить поиск" Click="ClearSearch_Click"/>
                </DockPanel>

                <ListView Grid.Row="4" ItemsSource="{Binding TemplateItemsView}" ScrollViewer.VerticalScrollBarVisibility="Auto">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <DockPanel Margin="2">
                                <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <TextBlock Text="{Binding Name}" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                            </DockPanel>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Grid>
        </GroupBox>

        <DockPanel Grid.Row="8" LastChildFill="False" HorizontalAlignment="Right">
            <Button Content="Закрыть" Width="120" Height="24"  Margin="0,0,10,0" HorizontalAlignment="Right" Click="Close_Click"/>
            <Button Content="Копировать шаблоны" Width="180" Height="24" HorizontalAlignment="Right" Click="CopyTemplates_Click"/>
        </DockPanel>

    </Grid>
</Window>