<Window x:Class="KPLN_DefaultPanelExtension_Modify.Forms.ListVPPositionMainFrom"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
        xmlns:local="clr-namespace:KPLN_DefaultPanelExtension_Modify.Forms"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        SizeToContent="WidthAndHeight"
        Background="#0F1115"
        FontFamily="Segoe UI"
        TextOptions.TextFormattingMode="Display"
        TextOptions.TextRenderingMode="ClearType"
        Closing="Window_Closing">


    <Window.InputBindings>
        <KeyBinding
        Key="Escape"
        Command="{Binding CloseWindowCmd}"
        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}" />
    </Window.InputBindings>

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="ListVPPositionCreateStyles.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>


    <Grid>
        <!-- Центровка карточки -->
        <Border 
        Width="550"
        Padding="28"
        Background="{StaticResource CardBgBrush}"
        Effect="{StaticResource CardShadow}"
        HorizontalAlignment="Center"
        VerticalAlignment="Center">

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Заголовок -->
                <StackPanel 
                Grid.Row="0" 
                Margin="0,0,0,18">
                    <TextBlock 
                    Text="Выбор конфигурации"
                    FontSize="30"
                    FontWeight="SemiBold"
                    Foreground="{StaticResource TextPrimaryBrush}"/>
                </StackPanel>

                <ScrollViewer 
                Grid.Row="1"
                VerticalScrollBarVisibility="Auto">
                    <Grid>
                        <ItemsControl 
                        x:Name="Items"
                        Height="500"
                        Background="{StaticResource SurfaceBrush}"
                        ItemsSource="{Binding ListVPPositionCreateItems, UpdateSourceTrigger=PropertyChanged}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Button 
                                    Style="{StaticResource PrimaryButton}"
                                    Tag="{Binding DataContext, RelativeSource={RelativeSource AncestorType=Window}}"
                                    Command="{Binding DataContext.SelectCmd, RelativeSource={RelativeSource AncestorType=Window}}"
                                    CommandParameter="{Binding}">
                                        <TextBlock 
                                        TextWrapping="Wrap"
                                        MaxWidth="250"
                                        TextAlignment="Center"
                                        Text="{Binding ConfigName}"/>
                                        <Button.ContextMenu>
                                            <ContextMenu>
                                                <MenuItem 
                                                Header="Удалить"
                                                Command="{Binding PlacementTarget.Tag.DeleteCmd, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                                CommandParameter="{Binding}"/>
                                            </ContextMenu>
                                        </Button.ContextMenu>
                                    </Button>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </Grid>
                </ScrollViewer>

                <!-- Создать/подсказка -->
                <DockPanel Grid.Row="2"
                    LastChildFill="False">
                    <Button 
                        Style="{StaticResource PrimaryButton}"
                        Content="Создать новую"
                        Width="400"
                        Command="{Binding CreateCmd}"/>
                    <Button 
                        Style="{StaticResource PrimaryButton}"
                        Content="?"
                        ToolTip="Открыть инструкцию на Moodle"
                        Width="60"
                        Command="{Binding HelpCmd}"
                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"/>
                </DockPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
